
# Cyb3rVector Escape-Pod Proxy

This Proxy has beed developed as a result of non suitable architecture design of the escape-pod and its extensions. It solves the problem of need for having multiple clients/extensions conneted to the same escape pod, by creating an additional communication layer, designed as server side event stream to fire the events generated by the escape-pod to all subscribed clients.


## Usage

This section describes how to build the escapepod

1. Export the appropriate environment variables

|Variable| Value | Description |
|--|--|--|
| CYB3RVECTOR_PROXY_CLIENT_PORT | 8089 | the TCP port the cybervector-proxy connects to escape-pod |
| CYB3RVECTOR_PROXY_CLIENT_INSECURE | true | Insecure TLS-free GRPC communication |
| CYB3RVECTOR_PROXY_CLIENT_CLIENT_AUTHENTICATION | NoClientCert | Insecure TLS-free GRPC communication |
| CYB3RVECTOR_PROXY_SERVER_PORT | 8090 | the TCP port the cybervector-proxy publishes events to clients |
| CYB3RVECTOR_PROXY_SERVER_INSECURE | true | Insecure TLS-free GRPC communication |
| CYB3RVECTOR_PROXY_SERVER_CLIENT_AUTHENTICATION | NoClientCert | Insecure TLS-free GRPC communication |

2. Build the ```cybervector-proxy``` service binary file

- Linux: ```$ make build```
- Windows: ```build.cmd```


## Deployment

This section describes how to deploy the Cyb3rVector Escape-Pod Proxy service to your Escape-Pod.

1. Make sure you've added the following lines to your escape pods config (in /etc/escape-pod.conf)

```sh
ENABLE_EXTENSIONS=true
ESCAPEPOD_EXTENDER_TARGET=0.0.0.0
ESCAPEPOD_EXTENDER_DISABLE_TLS=true
```

2. Deploy the ```cybervector-proxy``` binary to your escape pod (i.e /usr/local/bin/)

3. Create service, or a cron job to run the service with escape pod boot (TODO)

4. Restart your Escape-Pod and try the [Cyb3rVector](https://cyb3rdog.github.io/Cyb3rVector) application!


## Testing

You can test your build either locally, from the enviroment you develope in, or from the docker.

1. Ip Address

For any case, you need to know the ip address of the machine the service will run on, and 
correspondingly modify the ```ESCAPEPOD_EXTENDER_TARGET``` variable in your ```/etc/escape-pod.conf``` file

2. Start your application!
